"use strict";(self.webpackChunkdemo1=self.webpackChunkdemo1||[]).push([[752],{2752:(I,f,r)=>{r.r(f),r.d(f,{PermissionModule:()=>L});var d=r(177),a=r(9417),h=r(4550),c=r(837),g=r(4058),v=r(7470),b=r(691),e=r(4438),_=r(7586),C=r.n(_),j=r(1626);let x=(()=>{class n{http;apiUrl="https://preview.keenthemes.com/starterkit/metronic/laravel/api/v1/permissions";constructor(t){this.http=t}getPermissions(t){return this.http.post(`${this.apiUrl}-list`,t)}getPermission(t){return this.http.get(`${this.apiUrl}/${t}`)}createPermission(t){return this.http.post(this.apiUrl,t)}updatePermission(t,i){return this.http.put(`${this.apiUrl}/${t}`,i)}deletePermission(t){return this.http.delete(`${this.apiUrl}/${t}`)}static \u0275fac=function(i){return new(i||n)(e.KVO(j.Qq))};static \u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();var y=r(6100),k=r(5126);const P=["noticeSwal"],S=n=>({"ki-up":n});function F(n,p){1&n&&(e.j41(0,"div"),e.EFF(1,"Permission name is required"),e.k0s())}function M(n,p){1&n&&(e.j41(0,"div"),e.EFF(1,"Permission name must be at least 4 characters long"),e.k0s())}function E(n,p){if(1&n&&(e.j41(0,"div",37),e.DNE(1,F,2,0,"div",38)(2,M,2,0,"div",38),e.k0s()),2&n){e.XpG();const t=e.sdS(18);e.R7$(),e.Y8G("ngIf",null==t.errors?null:t.errors.required),e.R7$(),e.Y8G("ngIf",null==t.errors?null:t.errors.minlength)}}function w(n,p){if(1&n){const t=e.RV6();e.j41(0,"form",17,2),e.bIt("ngSubmit",function(s){e.eBV(t);const o=e.sdS(1),l=e.XpG();return e.Njj(l.onSubmit(s,o))}),e.j41(2,"div",18)(3,"h4",19),e.EFF(4,"Permission Details"),e.k0s(),e.j41(5,"button",20),e.bIt("click",function(){const s=e.eBV(t).$implicit;return e.Njj(s.dismiss("Cross click"))}),e.k0s()(),e.j41(6,"div",21)(7,"div",22)(8,"div",23),e.bIt("click",function(){e.eBV(t);const s=e.sdS(13);return e.Njj(s.toggle())}),e.EFF(9,"User Information "),e.j41(10,"span",24),e.nrm(11,"i",25),e.k0s()(),e.j41(12,"div",26,3),e.mxI("ngbCollapseChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.isCollapsed1,s)||(o.isCollapsed1=s),e.Njj(s)}),e.j41(14,"div",27)(15,"label",28),e.EFF(16,"Name"),e.k0s(),e.j41(17,"input",29,4),e.mxI("ngModelChange",function(s){e.eBV(t);const o=e.XpG();return e.DH7(o.permissionModel.name,s)||(o.permissionModel.name=s),e.Njj(s)}),e.k0s(),e.DNE(19,E,3,2,"div",30),e.k0s()()()(),e.j41(20,"div",31)(21,"button",32),e.bIt("click",function(){const s=e.eBV(t).$implicit;return e.Njj(s.dismiss("cancel"))}),e.EFF(22," Discard "),e.k0s(),e.j41(23,"button",33)(24,"span",34),e.EFF(25," Submit "),e.k0s(),e.j41(26,"span",35),e.EFF(27," Please wait... "),e.nrm(28,"span",36),e.k0s()()()()}if(2&n){const t=e.sdS(1),i=e.XpG();e.R7$(8),e.BMQ("aria-expanded",!i.isCollapsed1),e.R7$(3),e.Y8G("ngClass",e.eq3(6,S,!i.isCollapsed1)),e.R7$(),e.R50("ngbCollapse",i.isCollapsed1),e.R7$(5),e.R50("ngModel",i.permissionModel.name),e.R7$(2),e.Y8G("ngIf",t.submitted&&t.invalid),e.R7$(4),e.BMQ("data-kt-indicator",i.isLoading?"on":"off")}}let T=(()=>{class n{apiService;cdr;isCollapsed1=!1;isLoading=!1;permissions;datatableConfig={};reloadEvent=new e.bkB;permission$;permissionModel={id:0,name:""};noticeSwal;swalOptions={};constructor(t,i){this.apiService=t,this.cdr=i}ngAfterViewInit(){}ngOnInit(){this.datatableConfig={serverSide:!0,ajax:(t,i)=>{this.apiService.getPermissions(t).subscribe(s=>{console.log(s),i(s)})},columns:[{title:"Name",data:"name",render:(t,i,s)=>`<a href="javascript:;" data-action="view" data-id="${s.id}" class="text-gray-800 text-hover-primary mb-1">${t}</a>`},{title:"Assigned To",data:null,render:function(t,i,s){return Array.isArray(t.roles)?t.roles.map(function(o){return`<a href="#" class="badge fs-7 m-1 badge-light-${["info","success","warning","danger","primary"][Math.floor(5*Math.random())]}">${o.name}</a>`}).join(""):""},orderData:[1],orderSequence:["asc","desc"],type:"string"},{title:"Created Date",data:"created_at",render:function(t){return C()(t).format("DD MMM YYYY, hh:mm a")}}]}}delete(t){this.apiService.deletePermission(t).subscribe(()=>{this.reloadEvent.emit(!0)})}edit(t){this.permission$=this.apiService.getPermission(t),this.permission$.subscribe(i=>{this.permissionModel=i})}create(){this.permissionModel={id:0,name:""}}onSubmit(t,i){if(i&&i.invalid)return;this.isLoading=!0;const s={icon:"success",title:"Success!",text:this.permissionModel.id>0?"Permission updated successfully!":"Permission created successfully!"},o={icon:"error",title:"Error!",text:""},l=()=>{this.isLoading=!1};this.permissionModel.id>0?(()=>{this.apiService.updatePermission(this.permissionModel.id,this.permissionModel).subscribe({next:()=>{this.showAlert(s),this.reloadEvent.emit(!0)},error:u=>{o.text=this.extractText(u.error),this.showAlert(o),this.isLoading=!1},complete:l})})():(()=>{this.apiService.createPermission(this.permissionModel).subscribe({next:()=>{this.showAlert(s),this.reloadEvent.emit(!0)},error:u=>{o.text=this.extractText(u.error),this.showAlert(o),this.isLoading=!1},complete:l})})()}extractText(t){var i=[];for(var s in t)"string"==typeof t[s]?i.push(t[s]):"object"==typeof t[s]&&(i=i.concat(this.extractText(t[s])));return Array.from(new Set(i)).join("\n")}showAlert(t){let i=t.icon?.toString()||"success";"error"===t.icon&&(i="danger"),this.swalOptions=Object.assign({buttonsStyling:!1,confirmButtonText:"Ok, got it!",customClass:{confirmButton:"btn btn-"+i}},t),this.cdr.detectChanges(),this.noticeSwal.fire()}ngOnDestroy(){}static \u0275fac=function(i){return new(i||n)(e.rXU(x),e.rXU(e.gRc))};static \u0275cmp=e.VBU({type:n,selectors:[["app-permission-listing"]],viewQuery:function(i,s){if(1&i&&e.GBs(P,5),2&i){let o;e.mGM(o=e.lsd())&&(s.noticeSwal=o.first)}},decls:16,vars:4,consts:[["noticeSwal",""],["formModal",""],["myForm","ngForm"],["collapse1","ngbCollapse"],["name","ngModel"],[1,"card"],[1,"card-header","border-0","pt-6"],[1,"card-title"],[1,"d-flex","align-items-center","position-relative","my-1"],["name","magnifier",1,"fs-3","position-absolute","ms-5"],["type","text","data-action","filter","placeholder","Search Users",1,"form-control","form-control-solid","w-250px","ps-12"],[1,"card-toolbar"],[1,"d-flex","justify-content-end"],["type","button","data-action","create",1,"btn","btn-primary"],[1,"card-body","pt-0"],["route","/apps/users",3,"deleteEvent","editEvent","createEvent","datatableConfig","reload","modal"],[3,"swalOptions"],[3,"ngSubmit"],[1,"modal-header"],["id","modal-basic-title",1,"modal-title"],["type","button","aria-label","Close",1,"btn-close",3,"click"],[1,"modal-body"],["id","kt_modal_update_customer_scroll","data-kt-scroll","true","data-kt-scroll-activate","{default: false, lg: true}","data-kt-scroll-max-height","auto","data-kt-scroll-dependencies","#kt_modal_update_customer_header","data-kt-scroll-wrappers","#kt_modal_update_customer_scroll","data-kt-scroll-offset","300px",1,"d-flex","flex-column","scroll-y","me-n7","pe-7","mw-650px"],["data-bs-toggle","collapse","role","button","aria-controls","kt_modal_update_customer_user_info",1,"fw-bold","fs-3","rotate","collapsible","mb-7",3,"click"],[1,"ms-2","rotate-180"],[1,"ki-duotone","ki-down","fs-3",3,"ngClass"],[1,"collapse","show",3,"ngbCollapseChange","ngbCollapse"],[1,"fv-row","mb-7"],[1,"required","fw-semibold","fs-6","mb-2"],["type","text","name","name","required","","minlength","4",1,"form-control","form-control-solid",3,"ngModelChange","ngModel"],["class","fv-plugins-message-container fv-plugins-message-container--enabled invalid-feedback",4,"ngIf"],[1,"modal-footer","flex-center"],["type","reset","id","kt_modal_update_customer_cancel",1,"btn","btn-light","me-3",3,"click"],["type","submit","id","kt_modal_update_customer_submit",1,"btn","btn-primary"],[1,"indicator-label"],[1,"indicator-progress"],[1,"spinner-border","spinner-border-sm","align-middle","ms-2"],[1,"fv-plugins-message-container","fv-plugins-message-container--enabled","invalid-feedback"],[4,"ngIf"]],template:function(i,s){if(1&i){const o=e.RV6();e.j41(0,"div",5)(1,"div",6)(2,"div",7)(3,"div",8),e.nrm(4,"app-keenicon",9)(5,"input",10),e.k0s()(),e.j41(6,"div",11)(7,"div",12)(8,"button",13),e.EFF(9," Add Permissions "),e.k0s()()()(),e.j41(10,"div",14)(11,"app-crud",15),e.bIt("deleteEvent",function(m){return e.eBV(o),e.Njj(s.delete(m))})("editEvent",function(m){return e.eBV(o),e.Njj(s.edit(m))})("createEvent",function(){return e.eBV(o),e.Njj(s.create())}),e.k0s()()(),e.nrm(12,"swal",16,0),e.DNE(14,w,29,8,"ng-template",null,1,e.C5r)}if(2&i){const o=e.sdS(15);e.R7$(11),e.Y8G("datatableConfig",s.datatableConfig)("reload",s.reloadEvent)("modal",o),e.R7$(),e.Y8G("swalOptions",s.swalOptions)}},dependencies:[d.YU,d.bT,a.qT,a.me,a.BC,a.cb,a.YS,a.xh,a.vS,a.cV,y.i,k.w,c.$G,g.b7]})}return n})(),$=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275cmp=e.VBU({type:n,selectors:[["app-permission-details"]],decls:2,vars:0,template:function(i,s){1&i&&(e.j41(0,"p"),e.EFF(1,"permission-details works!"),e.k0s())}})}return n})(),L=(()=>{class n{static \u0275fac=function(i){return new(i||n)};static \u0275mod=e.$C({type:n});static \u0275inj=e.G2t({imports:[d.MD,a.YN,a.X1,h.iI.forChild([{path:"",component:T},{path:":id",component:$}]),b.B,v.G,c.Pv,c.zH,c.HC,c.n8,g.RZ.forChild()]})}return n})()}}]);